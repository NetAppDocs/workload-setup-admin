---
sidebar: sidebar
permalink: manage-credentials.html
keywords: permissions, aws, policy, iam, iam role, role, granting, policy, iam policy, iam user, access keys, arn, cloud provider accounts, aws, cloud provider profile, json, iam, credentials, adding credentials, add credentials
summary: Add and manage AWS credentials so that Workload Factory has the permissions that it needs to deploy and manage cloud resources in your AWS accounts.
---

= Manage AWS credentials
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Add and manage AWS credentials so that Workload Factory has the permissions that it needs to deploy and manage cloud resources in your AWS accounts. 

== Overview

Workload Factory will operate in Basic mode unless you add AWS account credentials. You can add credentials to enable other operation modes, such as Read mode and Automate mode. link:operational-modes.html[See Operational Modes for details].

You can add AWS credentials to an existing account in Workload Factory from the Credentials page. This provides the permissions needed to manage resources and processes within your AWS cloud environment.

You can choose to add credentials manually where you create the IAM policy and the IAM role in your AWS account, or you can automate the creation of the credentials by launching a CloudFormation stack to create the IAM policies and IAM roles for you.

== Add credentials manually to a Workload Factory account

You can add AWS credentials to Workload Factory manually to give Workload Factory the permissions needed to manage the resources that you'll use to run your unique workloads. Each set of credentials that you add will include one or more IAM policies based on the workload capabilities you want to use, and an IAM role.

There are three parts to creating the credentials:

* Select the Workload Factory capabilities that you want to use; FSx for ONTAP file systems, database workloads, AI workloads, and more.
* Create the IAM policies for those capabilities in the AWS Management Console.
* Create the IAM role in the AWS Management Console.

.Prerequisites

* You'll need to have credentials for your AWS account.
* something else...

.Steps

. In the Workload Factory console, select the *Account Settings* icon, and select *Credentials*.
+
image:screenshot-settings-icon.png[A screenshot that shows the Account Settings icon in the Workload Factory console.]

. On the *Credentials* page, click *Add credentials* and the Add credentials page is displayed.

. Click *Add manually* and fill out the three sections under Permissions configuration.
+
image:screenshot-add-credentials-manually.png[A screenshot showing the items that need to be defined manually for each set of credentials.]

=== Create the IAM policies

In this section you can choose which types of workload capabilities will be manageable as part of these credentials, and the permissions enabled for each workload. You'll need to copy the policy permissions for each workload from the Codebox and add them into the AWS Management Console within your account.

image:screenshot-create-policies.png[A screenshot showing which types of workload capabilities will be manageable as part of these credentials.]

.Steps

. Enable each of the workload capabilities that you want to include in these credentials.

. For those workload capabilities that offer a variety of permissions (operate, view, etc.), select the types of permissions that will be available with these credentials.

. Open another browser window and follow the steps outlined in the UI to add the the policies for each selected workload capability to the policy page in the AWS Management Console.

. Follow those steps for each set of permissions based on the workloads you selected.

=== Create the IAM role

In this section you can set up an IAM role that enables Workload Factory to assume the role that includes the permissions and policies that you just created.

image:screenshot-create-role.png[A screenshot showing which types of workload capabilities will be manageable as part of these credentials.]

.Steps

. Go to the IAM console in the target account.

. Under Access Management, select *Roles > Create Role* and follow the steps to create the role.
+
Be sure to do the following:

* Under *Trusted entity type*, select *AWS account*.
* Select *Another AWS account* and enter the ID of the Workload Factory SaaS: 733004784675
* Create a policy that includes the permissions required to create a Connector.

. Click *Next*.

. In the Permissions policy section, choose all of the policies that you defined previously and click *Next*.

. Enter a name for the role and click *Create role*.

. Copy the Role ARN of the IAM role, and then return to the Workload Factory UI and paste it in the Role ARN field.

=== Create the credentials name

. Enter the name that you want to use for these credentials.

. Click *Add* to create the credentials.

.Result

The credentials are created and you are returned to the Credentials page.

== Add credentials to a Workload Factory account using CloudFormation

You can add AWS credentials to Workload Factory using a CloudFormation stack by selecting the Workload Factory capabilities that you want to use, and then launching the AWS CloudFormation stack in your AWS account. 

Each set of credentials that you add will include one or more IAM policies based on the workload capabilities you want to use, and an IAM role.

.Prerequisites

* You'll need to have credentials for your AWS account.
* something else...

.Steps

. In the Workload Factory console, select the *Account Settings* icon, and select *Credentials*.
+
image:screenshot-settings-icon.png[A screenshot that shows the Account Settings icon in the Workload Factory console.]

. On the *Credentials* page, click *Add credentials* and the Add credentials page is displayed.

. Click *Add via AWS CloudFormation* and fill out the two sections under Permissions configuration.
+
image:screenshot-add-credentials-cloudformation.png[A screenshot showing the items that need to be defined manually for each set of credentials.]


Delete the remaining stuff ??



== How to rotate credentials
 
Workload Factory enables you to provide AWS credentials in a few ways: an IAM role associated with the account, by assuming an IAM role in a trusted account, or by providing AWS access keys.
 
With the first two options, Workload Factory uses the AWS Security Token Service to obtain temporary credentials that rotate constantly. This process is the best practice because it's automatic and it's secure.
 
If you provide Workload Factory with AWS access keys, you should rotate the keys by updating them in Workload Factory at a regular interval. This is a completely manual process.
 
== Add additional credentials to an account
 
You can add additional AWS credentials to an account so that it has the permissions needed to manage resources and processes within your public cloud environment. You can either provide the ARN of an IAM role in another account or provide AWS access keys.
 
=== Grant permissions
 
Before you add AWS credentials to an account, you need to provide the required permissions. The permissions enable Workload Factory to manage resources and processes within that AWS account. How you provide the permissions depends on whether you want to provide Workload Factory with the ARN of a role in a trusted account or AWS keys.
 
*Choices*
 
* <<Grant permissions by assuming an IAM role in another account>>
* <<Grant permissions by providing AWS keys>>
 
==== Grant permissions by assuming an IAM role in another account
 
You can set up a trust relationship between the source AWS account and other AWS accounts by using IAM roles. You would then provide Workload Factory with the ARN of the IAM roles from the trusted accounts.

.Steps

. Go to the IAM console in the target account in which you want to provide the Connector with permissions.

. Under Access Management, select *Roles > Create Role* and follow the steps to create the role.
+
Be sure to do the following:

* Under *Trusted entity type*, select *AWS account*.
* Select *Another AWS account* and enter the ID of the account where the Connector instance resides.
* Create the required policies by copying and pasting the contents of link:reference-permissions-aws.html[the IAM policies for the Connector].

. Copy the Role ARN of the IAM role so that you can paste it in Workload Factory later on.

.Result

The account now has the required permissions.

==== Grant permissions by providing AWS keys

If you want to provide Workload Factory with AWS keys for an IAM user, then you need to grant the required permissions to that user. The Workload Factory IAM policy defines the AWS actions and resources that Workload Factory is allowed to use.

.Steps

. From the IAM console, create policies by copying and pasting the contents from the Codebox.

. Attach the policies to an IAM role or an IAM user.
+
* https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create.html[AWS Documentation: Creating IAM Roles^]
* https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html[AWS Documentation: Adding and Removing IAM Policies^]

.Result

The account now has the required permissions. 

=== Add the credentials

After you provide an AWS account with the required permissions, you can add the credentials for that account to an existing Connector. 

.Before you begin

If you just created these credentials in your cloud provider, it might take a few minutes until they are available for use. Wait a few minutes before you add the credentials to Workload Factory.

.Steps

. In the upper right of the Workload Factory console, select the *Account Settings* icon, and select *Credentials*.
+
image:screenshot_settings_icon.gif[A screenshot that shows the Settings icon in the upper right of the BlueXP console.]

. On the *Credentials* page, click *Add Credentials* and follow the steps in the wizard.

.. *Credentials Location*: Select *Amazon Web Services > Connector*.

.. *Define Credentials*: Provide the ARN (Amazon Resource Name) of a trusted IAM role, or enter an AWS access key and secret key.

.. *Review*: Confirm the details about the new credentials and select *Add*.

.Result

You can now switch to a different set of credentials from the Details and Credentials page:

image:screenshot_accounts_switch_aws.png[A screenshot that shows selecting between cloud provider accounts after selecting Switch Account in the Details & Credentials page.]



=== Add the credentials

After you provide the IAM role with the required permissions, add the role ARN to Workload Factory.

.Before you begin

If you just created the IAM role, it might take a few minutes until they are available for use. Wait a few minutes before you add the credentials to Workload Factory.

.Steps

. In the Workload Factory console, select the *Account Settings* icon, and select *Credentials*.
+
image:screenshot-settings-icon.png[A screenshot that shows the Settings icon in the upper right of the Workload Factory console.]

. On the *Credentials* page, click *Add credentials* and follow the steps in the wizard.

.. *Credentials Location*: Select *Amazon Web Services > BlueXP*.

.. *Define Credentials*: Provide the ARN (Amazon Resource Name) of the IAM role.

.. *Review*: Confirm the details about the new credentials and select *Add*.

.Result

You can now use the credentials when creating a new Connector.

== Edit credentials

Edit your AWS credentials in BlueXP by changing the account type (AWS keys or assume role), by editing the name, or by updating the credentials themselves (the keys or the role ARN).

.Steps

. In the Workload Factory console, select the *Account Settings* icon, and select *Credentials*.

. On the *Credentials* page, select the action menu for a set of credentials and then select *Edit Credentials*.

. Make the required changes and then select *Apply*.

== Remove credentials

If you no longer need a set of credentials, you can delete them from Workload Factory. You can only delete credentials that aren't associated with a working environment.

.Steps

. In the Workload Factory console, select the *Account Settings* icon, and select *Credentials*.

. On the *Credentials* page, select the action menu for a set of credentials and then select *Remove*.

. Select *Remove* to confirm.